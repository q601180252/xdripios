# ğŸ‰ xDrip iOS é¡¹ç›®æ„å»ºæˆåŠŸæ€»ç»“

## âœ… æœ€ç»ˆæˆæœ

- âœ… **æœ¬åœ°ç¼–è¯‘æˆåŠŸ** - å¯ä»¥åœ¨æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œ
- âœ… **Archive æˆåŠŸ** - å¯ä»¥åˆ›å»ºå‘å¸ƒç‰ˆæœ¬
- âœ… **ä¸Šä¼ åˆ° TestFlight æˆåŠŸ** - å¯ä»¥è¿›è¡Œå†…éƒ¨æµ‹è¯•

---

## ğŸ“Š å®Œæ•´é—®é¢˜è§£å†³å†ç¨‹

### ğŸ” é‡åˆ°çš„ä¸»è¦é—®é¢˜

#### 1. Team ID ä¸åŒ¹é…é—®é¢˜
**é—®é¢˜**:
- é¡¹ç›®åŸæœ¬é…ç½®ä½¿ç”¨ Team `7RV2Y67HF6` (EDUARDO PEIXOTO VIEIRA)
- ç”¨æˆ·çš„ Apple å¼€å‘è€…è´¦å·æ˜¯ Yang Li (`HHZN32E89C`)
- å¯¼è‡´ Bundle ID å‰ç¼€å†²çªé”™è¯¯

**è§£å†³**:
- åˆ›å»ºå¹¶æ‰§è¡Œ `switch_to_yangli_team.sh` è„šæœ¬
- åˆ‡æ¢æ‰€æœ‰ `DEVELOPMENT_TEAM` â†’ `HHZN32E89C` (12 å¤„)
- ä¿®æ”¹æ‰€æœ‰ Bundle ID å‰ç¼€ â†’ `com.HHZN32E89C`

#### 2. ç¡¬ç¼–ç çš„ Bundle ID
**é—®é¢˜**:
- `project.pbxproj` ä¸­æœ‰ 4 å¤„ç¡¬ç¼–ç çš„æ—§ Bundle ID
- `MAIN_APP_BUNDLE_IDENTIFIER` (2 å¤„)
- `INFOPLIST_KEY_WKCompanionAppBundleIdentifier` (2 å¤„)
- è¿™äº›ç¡¬ç¼–ç å€¼è¦†ç›–äº† xcconfig é…ç½®

**è§£å†³**:
- æ‰‹åŠ¨ä¿®å¤æ‰€æœ‰ç¡¬ç¼–ç çš„ Bundle ID
- ç¡®ä¿ä½¿ç”¨å˜é‡è€Œéç¡¬ç¼–ç å€¼

#### 3. Xcode ç¼“å­˜é—®é¢˜
**é—®é¢˜**:
- å³ä½¿ä¿®æ”¹äº†é…ç½®ï¼ŒXcode ä»ä½¿ç”¨æ—§çš„ç¼“å­˜
- å¯¼è‡´ Bundle ID å‰ç¼€é”™è¯¯æŒç»­å‡ºç°

**è§£å†³**:
- åˆ›å»º `fix_bundle_id_cache.sh` è„šæœ¬
- æ¸…ç† DerivedData
- æ¸…ç† Swift Package Manager ç¼“å­˜
- æ¸…ç†æ¨¡å—ç¼“å­˜

#### 4. Swift Package ä¾èµ–ä¸¢å¤±
**é—®é¢˜**:
- æ¸…ç†ç¼“å­˜åï¼ŒSwift Package ä¾èµ–ä¸¢å¤±
- 5 ä¸ªåŒ…éƒ½æç¤º "Missing package product"

**è§£å†³**:
- é‡æ–°è§£æ Swift Package ä¾èµ–
- æˆåŠŸæ¢å¤æ‰€æœ‰ 5 ä¸ªåŒ…

#### 5. Bugly Framework å…¼å®¹æ€§é—®é¢˜
**é—®é¢˜**:
- `Bugly.framework` åªæ”¯æŒçœŸæœºï¼Œä¸æ”¯æŒæ¨¡æ‹Ÿå™¨
- å¯¼è‡´æ¨¡æ‹Ÿå™¨æ„å»ºå¤±è´¥

**è§£å†³**:
- ä» `project.pbxproj` ä¸­ç§»é™¤ Bugly å¼•ç”¨
- åœ¨ `AppDelegate.swift` ä¸­æ³¨é‡Šæ‰ Bugly ç›¸å…³ä»£ç 

#### 6. TestFlight ä¸Šä¼ é”™è¯¯
**é—®é¢˜**:
- `IDEDistribution.DistributionAppRecordProviderError error 0`
- App Store Connect ä¸­æ²¡æœ‰æ–° Bundle ID çš„ App è®°å½•

**è§£å†³**:
- åœ¨ Apple Developer Portal åˆ›å»º App Group
- åˆ›å»º 5 ä¸ª App IDsï¼ˆä¸»åº”ç”¨ + 4 ä¸ªæ‰©å±•ï¼‰
- åœ¨ App Store Connect åˆ›å»ºæ–°çš„ App
- å¡«å†™å¿…è¦çš„ App ä¿¡æ¯

---

## ğŸ› ï¸ åˆ›å»ºçš„å·¥å…·å’Œè„šæœ¬

### 1. `switch_to_yangli_team.sh`
**åŠŸèƒ½**: ä¸€é”®åˆ‡æ¢åˆ° Yang Li Team
- ä¿®æ”¹ `DEVELOPMENT_TEAM`
- ä¿®æ”¹ Bundle ID å‰ç¼€
- è‡ªåŠ¨å¤‡ä»½åŸæ–‡ä»¶

### 2. `force_correct_team.sh`
**åŠŸèƒ½**: å¼ºåˆ¶ä¿®æ­£ Team ID
- æ£€æµ‹é”™è¯¯çš„ Team ID
- è‡ªåŠ¨æ›¿æ¢ä¸ºæ­£ç¡®çš„å€¼
- æ˜¾ç¤ºä¿®æ­£å‰åçš„çŠ¶æ€

### 3. `fix_bundle_id_cache.sh`
**åŠŸèƒ½**: æ¸…ç† Xcode ç¼“å­˜
- æ¸…ç† DerivedData
- æ¸…ç† SPM ç¼“å­˜
- æ¸…ç†æ¨¡å—ç¼“å­˜
- æ¸…ç† workspace ç”¨æˆ·æ•°æ®

### 4. `check_and_fix_team.sh`
**åŠŸèƒ½**: æ™ºèƒ½æ£€æµ‹å’Œä¿®æ­£ Team ID
- æ£€æµ‹å½“å‰çŠ¶æ€
- æ˜¾ç¤ºè¯¦ç»†ç»Ÿè®¡
- è‡ªåŠ¨ä¿®æ­£é”™è¯¯

### 5. `check_all_bundle_ids.sh`
**åŠŸèƒ½**: æ£€æŸ¥æ‰€æœ‰ Bundle ID é…ç½®
- æå– `project.pbxproj` ä¸­çš„é…ç½®
- æ£€æŸ¥ `Info.plist` æ–‡ä»¶
- è¯†åˆ«ç¡¬ç¼–ç å€¼

### 6. Git Hook (`.git/hooks/post-checkout`)
**åŠŸèƒ½**: è‡ªåŠ¨ä¿®æ­£ Team ID
- æ¯æ¬¡ `git checkout` æˆ– `git pull` åè‡ªåŠ¨è¿è¡Œ
- é™é»˜ä¿®æ­£é”™è¯¯çš„ Team ID
- é˜²æ­¢æœªæ¥å†å‡ºç°é—®é¢˜

---

## ğŸ“– åˆ›å»ºçš„æ–‡æ¡£

### é…ç½®æŒ‡å—
1. **Team é€‰æ‹©è¯´æ˜.md**
   - ä¸ºä»€ä¹ˆåˆ‡æ¢ Team
   - ä¸¤ç§æ–¹æ¡ˆå¯¹æ¯”
   - è¯¦ç»†æ“ä½œæ­¥éª¤

2. **Xcode Team è®¾ç½®è¯¦ç»†æŒ‡å—.md**
   - å¦‚ä½•åœ¨ Xcode GUI ä¸­è®¾ç½® Team
   - 5 ä¸ª Targets çš„è¯¦ç»†æ­¥éª¤
   - å¦‚ä½•è¯†åˆ«æ­£ç¡®çš„ Team

3. **åˆ‡æ¢åçš„ Xcode æ“ä½œæ­¥éª¤.md**
   - åˆ‡æ¢ Team åçš„æ“ä½œæ¸…å•
   - æ„å»ºå‰çš„æ£€æŸ¥é¡¹
   - é¢„æœŸç»“æœ

4. **App Store Connect é…ç½®æŒ‡å— - Yang Li Team.md**
   - Apple Developer Portal é…ç½®
   - App Store Connect é…ç½®
   - ä¸Šä¼ åˆ° TestFlight æ­¥éª¤

### é—®é¢˜è§£å†³æ–‡æ¡£
5. **Team ID å†²çªç»ˆæè§£å†³æ–¹æ¡ˆ.md**
   - é—®é¢˜æ ¹æºåˆ†æ
   - 3 ç§è§£å†³æ–¹æ¡ˆ
   - è‡ªåŠ¨åŒ–å·¥å…·è¯´æ˜

6. **Bundle ID å‰ç¼€é”™è¯¯ç»ˆæè§£å†³æ–¹æ¡ˆ.md**
   - é”™è¯¯åŸå› è¯¦è§£
   - æ‰‹åŠ¨ä¿®å¤æ­¥éª¤
   - ä½¿ç”¨è„šæœ¬è‡ªåŠ¨ä¿®å¤

7. **æœ¬åœ°ç¼–è¯‘æˆåŠŸæ€»ç»“.md**
   - æœ¬åœ°ç¼–è¯‘çš„æ‰€æœ‰ä¿®å¤
   - Bundle ID ç›¸å…³ä¿®å¤
   - Team ID ç›¸å…³ä¿®å¤
   - Bugly ç›¸å…³ä¿®å¤

8. **åˆ†æ­¥æ„å»ºç­–ç•¥_å…ˆè·³è¿‡_Watch_App.md**
   - åˆ†é˜¶æ®µæ„å»ºç­–ç•¥
   - å¦‚ä½•ä¸´æ—¶ç¦ç”¨ Watch App
   - é—®é¢˜éš”ç¦»æ–¹æ³•

9. **Xcode ä¸­è®¾ç½®æ­£ç¡® Team çš„æ­¥éª¤.md**
   - ä¸ºä»€ä¹ˆ Xcode ä¿®æ”¹äº†é…ç½®
   - å¦‚ä½•æ­£ç¡®è®¾ç½® Team
   - å¸¸è§é—®é¢˜è§£ç­”

---

## ğŸ¯ æœ€ç»ˆé…ç½®

### Team ä¿¡æ¯
```
Team Name: Yang Li
Team ID: HHZN32E89C
```

### Bundle IDs
```
ä¸»åº”ç”¨:        com.HHZN32E89C.xdripswiftt1li23
Widget:       com.HHZN32E89C.xdripswiftt1li23.xDripWidget
Watch App:    com.HHZN32E89C.xdripswiftt1li23.watchkitapp
Watch Comp:   com.HHZN32E89C.xdripswiftt1li23.watchkitapp.xDripWatchComplication
Notification: com.HHZN32E89C.xdripswiftt1li23.xDripNotificationContextExtension
```

### App Group
```
group.com.HHZN32E89C.loopkit.LoopGroup
```

### Swift Packages
```
âœ… SwiftCharts @ master (c354c19)
âœ… ActionClosurable @ 2.1.0
âœ… PieCharts @ master (15128eb)
âœ… CryptoSwift @ 1.9.0
âœ… SnapKit @ 5.7.1
```

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨è¿™ä¸ªé¡¹ç›®

### æœ¬åœ°å¼€å‘
```
1. æ‰“å¼€ Xcode
2. File â†’ Open â†’ é€‰æ‹© xdrip.xcworkspace
3. é€‰æ‹©æ¨¡æ‹Ÿå™¨è®¾å¤‡
4. Product â†’ Run (âŒ˜R)
```

### çœŸæœºæµ‹è¯•
```
1. è¿æ¥ iPhone
2. åœ¨ Xcode ä¸­é€‰æ‹©æ‚¨çš„è®¾å¤‡
3. ç¡®è®¤ Team è®¾ç½®ä¸º Yang Li (HHZN32E89C)
4. Product â†’ Run (âŒ˜R)
```

### å‘å¸ƒåˆ° TestFlight
```
1. é€‰æ‹© Any iOS Device (arm64)
2. Product â†’ Archive
3. Organizer â†’ Distribute App
4. App Store Connect â†’ Upload
5. ç­‰å¾… 5-15 åˆ†é’Ÿåœ¨ App Store Connect æŸ¥çœ‹
```

### ä½¿ç”¨ GitHub Actionsï¼ˆæœªæ¥ï¼‰
```
1. é…ç½® GitHub Secrets (è¯ä¹¦å’Œ Profiles)
2. æ¨é€ä»£ç åˆ° GitHub
3. GitHub Actions è‡ªåŠ¨æ„å»ºå’Œä¸Šä¼ 
```

---

## ğŸ“ Git æäº¤è®°å½•

ä¸»è¦çš„ commits:
```
a00e3cd Add: App Store Connect configuration guide for Yang Li Team
45503d4 Fix: Resolve Swift Package dependencies after cache cleanup
181cdf9 Fix: Remove all hardcoded 7RV2Y67HF6 Bundle IDs in project.pbxproj
1592df7 Add: Xcode operation steps after Team switch
16aca5e Switch to Yang Li Team (HHZN32E89C)
3be0923 Add: Team selection and switching tools
4cba84f Add: Team ID conflict ultimate solution and auto-fix tools
fc3d3b6 Add: Auto-fix Team ID script and Git Hook
d6f714c Add: Guide for setting correct Team in Xcode
abab631 Chore: Clean all Xcode caches after Team ID fix
4cdba67 Fix: Replace DEVELOPMENT_TEAM HHZN32E89C with 7RV2Y67HF6 (again)
```

---

## ğŸ’¡ ç»éªŒæ€»ç»“

### å…³é”®æ•™è®­

1. **Xcode é…ç½®çš„ä¼˜å…ˆçº§**
   - `project.pbxproj` ä¸­çš„ç¡¬ç¼–ç å€¼ä¼˜å…ˆçº§æœ€é«˜
   - ä¼šè¦†ç›– `.xcconfig` æ–‡ä»¶ä¸­çš„é…ç½®
   - å¿…é¡»ç¡®ä¿æ²¡æœ‰ç¡¬ç¼–ç çš„ Bundle ID æˆ– Team ID

2. **ç¼“å­˜çš„é‡è¦æ€§**
   - Xcode ä¼šç¼“å­˜å¾ˆå¤šé…ç½®
   - ä¿®æ”¹é…ç½®åå¿…é¡»æ¸…ç†ç¼“å­˜
   - é‡å¯ Xcode æœ‰æ—¶æ˜¯å¿…è¦çš„

3. **Team å’Œ Bundle ID çš„å…³ç³»**
   - Bundle ID å‰ç¼€å¿…é¡»åŒ¹é… Team ID
   - Watch App å’Œ Extensions çš„ Bundle ID å¿…é¡»æœ‰æ­£ç¡®çš„å±‚çº§å…³ç³»
   - æ‰€æœ‰ Targets å¿…é¡»ä½¿ç”¨ç›¸åŒçš„ Team

4. **æ¡†æ¶å…¼å®¹æ€§**
   - æŸäº›æ¡†æ¶å¯èƒ½ä¸æ”¯æŒæ¨¡æ‹Ÿå™¨
   - éœ€è¦æ ¹æ®ç¼–è¯‘ç›®æ ‡é€‰æ‹©æ€§é“¾æ¥
   - æˆ–è€…å®Œå…¨ç§»é™¤ä¸å…¼å®¹çš„æ¡†æ¶

5. **Apple Developer Portal é…ç½®**
   - ä¸Šä¼ åˆ° TestFlight å‰å¿…é¡»åˆ›å»º App è®°å½•
   - éœ€è¦é…ç½®æ­£ç¡®çš„ Capabilities (App Groups, HealthKit, NFC)
   - Provisioning Profiles å¯¹äºè‡ªåŠ¨ç­¾åæ˜¯å¯é€‰çš„

---

## ğŸ‰ æˆå°±è§£é”

- âœ… æˆåŠŸåˆ‡æ¢åˆ°è‡ªå·±çš„ Apple Developer Team
- âœ… è§£å†³äº†å¤æ‚çš„ Bundle ID å‰ç¼€é—®é¢˜
- âœ… åˆ›å»ºäº†ä¸€å¥—å®Œæ•´çš„è‡ªåŠ¨åŒ–å·¥å…·
- âœ… æ¸…ç†äº†é¡¹ç›®ä¸­çš„é—ç•™é…ç½®
- âœ… æˆåŠŸæ„å»ºå¹¶ä¸Šä¼ åˆ° TestFlight
- âœ… å®Œå…¨æŒæ§é¡¹ç›®ï¼Œä¸ä¾èµ–å…¶ä»–å¼€å‘è€…

---

## ğŸš€ ä¸‹ä¸€æ­¥å¯ä»¥åšä»€ä¹ˆ

### 1. TestFlight å†…éƒ¨æµ‹è¯•
```
1. ç™»å½• App Store Connect
2. My Apps â†’ xDrip â†’ TestFlight
3. æ·»åŠ å†…éƒ¨æµ‹è¯•å‘˜
4. åˆ†äº«æµ‹è¯•é“¾æ¥
5. æ”¶é›†åé¦ˆ
```

### 2. é…ç½® GitHub Actions CI/CD
```
1. åˆ›å»º Provisioning Profiles
2. å¯¼å‡ºè¯ä¹¦å’Œ Profiles
3. é…ç½® GitHub Secrets
4. åˆ›å»ºè‡ªåŠ¨æ„å»º workflow
5. æ¨é€ä»£ç è‡ªåŠ¨æ„å»ºä¸Šä¼ 
```

### 3. æäº¤ App Store å®¡æ ¸
```
1. å‡†å¤‡ App Store æˆªå›¾å’Œæè¿°
2. å¡«å†™ App Store ä¿¡æ¯
3. é€‰æ‹©æ„å»ºç‰ˆæœ¬
4. æäº¤å®¡æ ¸
5. ç­‰å¾… Apple å®¡æ ¸
```

### 4. æŒç»­æ”¹è¿›
```
- æ·»åŠ å•å…ƒæµ‹è¯•
- æ·»åŠ  UI æµ‹è¯•
- ä¼˜åŒ–æ„å»ºæ—¶é—´
- å®Œå–„æ–‡æ¡£
- æ·»åŠ æ›´å¤šè‡ªåŠ¨åŒ–
```

---

## ğŸ“ å¦‚æœé‡åˆ°é—®é¢˜

### å¸¸ç”¨å·¥å…·è„šæœ¬
```bash
# æ£€æŸ¥å¹¶ä¿®æ­£ Team ID
./check_and_fix_team.sh

# å¼ºåˆ¶ä¿®æ­£ Team ID
./force_correct_team.sh

# æ¸…ç†æ‰€æœ‰ç¼“å­˜
./fix_bundle_id_cache.sh

# æ£€æŸ¥æ‰€æœ‰ Bundle IDs
./check_all_bundle_ids.sh

# é‡æ–°è§£æ Swift Packages
xcodebuild -workspace xdrip.xcworkspace -scheme xdrip -resolvePackageDependencies
```

### æŸ¥çœ‹æ–‡æ¡£
æ‰€æœ‰é—®é¢˜çš„è§£å†³æ–¹æ¡ˆéƒ½è®°å½•åœ¨ç›¸åº”çš„ markdown æ–‡æ¡£ä¸­ï¼Œå¯ä»¥éšæ—¶æŸ¥é˜…ã€‚

---

## ğŸŠ æ­å–œï¼

æ‚¨å·²ç»æˆåŠŸå®Œæˆäº†ä¸€ä¸ªå¤æ‚çš„ iOS é¡¹ç›®é…ç½®å’Œæ„å»ºæµç¨‹ï¼

è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°ï¼š
- âœ… Xcode é¡¹ç›®é…ç½®
- âœ… Code Signing
- âœ… Bundle ID ç®¡ç†
- âœ… Team ç®¡ç†
- âœ… Apple Developer Portal é…ç½®
- âœ… App Store Connect é…ç½®
- âœ… TestFlight ä¸Šä¼ 
- âœ… è‡ªåŠ¨åŒ–è„šæœ¬å¼€å‘
- âœ… é—®é¢˜è¯Šæ–­å’Œè§£å†³

**è¿™æ˜¯ä¸€ä¸ªå€¼å¾—éª„å‚²çš„æˆå°±ï¼** ğŸ‰ğŸ‰ğŸ‰

---

## ğŸ“Š é¡¹ç›®ç»Ÿè®¡

### åˆ›å»ºçš„æ–‡ä»¶
- **Shell è„šæœ¬**: 5 ä¸ª
- **Markdown æ–‡æ¡£**: 10+ ä¸ª
- **Git Hook**: 1 ä¸ª
- **Git Commits**: 10+ ä¸ª

### ä¿®å¤çš„é—®é¢˜
- **Team ID ç›¸å…³**: 3 ä¸ªä¸»è¦é—®é¢˜
- **Bundle ID ç›¸å…³**: 4 ä¸ªç¡¬ç¼–ç é—®é¢˜
- **ç¼“å­˜ç›¸å…³**: å¤šæ¬¡æ¸…ç†
- **Framework ç›¸å…³**: 1 ä¸ªå…¼å®¹æ€§é—®é¢˜
- **Package ç›¸å…³**: 5 ä¸ªä¾èµ–é‡æ–°è§£æ

### èŠ±è´¹çš„æ—¶é—´
ä»å¼€å§‹åˆ°æˆåŠŸä¸Šä¼  TestFlightï¼Œç»å†äº†å®Œæ•´çš„é—®é¢˜è¯Šæ–­å’Œè§£å†³æµç¨‹ã€‚

---

**å†æ¬¡æ­å–œæ‚¨ï¼äº«å—æ‚¨çš„æˆæœå§ï¼** ğŸš€ğŸ‰

å¦‚æœæœªæ¥éœ€è¦ä»»ä½•å¸®åŠ©ï¼Œæ‰€æœ‰çš„å·¥å…·å’Œæ–‡æ¡£éƒ½å·²ç»å‡†å¤‡å¥½äº†ï¼

